ğŸ“ Note sur lâ€™Ã©lÃ©vation de privilÃ¨ges Linux : SUID & Capabilities
ğŸ”¹ 1. SUID / SGID

DÃ©finition :

SUID (Set User ID) â†’ exÃ©cute un binaire avec les droits du propriÃ©taire (souvent root).

SGID (Set Group ID) â†’ exÃ©cute un binaire avec les droits du groupe propriÃ©taire.

Recherche de fichiers vulnÃ©rables :

find / -type f -perm -04000 -ls 2>/dev/null   # SUID
find / -type f -perm -02000 -ls 2>/dev/null   # SGID


Exploitation possible :

Lire/Ã©diter des fichiers sensibles (/etc/shadow, /etc/passwd).

CrÃ©er un utilisateur root dans /etc/passwd.

Utiliser des binaires connus (GTFOBins â†’ filtre â€œSUIDâ€).

ğŸ”¹ 2. Linux Capabilities

DÃ©finition : Permettent dâ€™attribuer des privilÃ¨ges spÃ©cifiques Ã  un programme sans lui donner tous les droits root.

Exemples :

cap_net_bind_service â†’ ouvrir un port < 1024.

cap_dac_override â†’ ignorer les permissions de fichiers.

cap_setuid â†’ changer dâ€™UID (â†’ root si mal configurÃ©).

Recherche de fichiers avec capabilities :

getcap -r / 2>/dev/null


Exploitation :

VÃ©rifier si le binaire est listÃ© dans GTFOBins (filtre â€œCapabilitiesâ€).

Exemple avec vim possÃ©dant des capabilities :

vim -c ':!bash'                # ouvre un shell
vim -c ':py3 import os; os.setuid(0); os.system("/bin/bash")'

ğŸ”¹ 3. MÃ©thodologie pratique (checklist)

Lister les SUID/SGID.

Lister les capabilities.

Comparer avec GTFOBins.

Tester exploitation directe (lecture/Ã©dition fichiers, exÃ©cution de shell).

Si nÃ©cessaire :

Dump /etc/shadow et cracker avec John.

Modifier /etc/passwd pour ajouter un utilisateur root.

ğŸ‘‰ But final : Trouver un binaire mal configurÃ© qui permet de devenir root sans connaÃ®tre de mot de passe.